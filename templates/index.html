<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Upload Excel</title>
  <!-- Link to our external stylesheet -->
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css" />
  <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.dataTables.min.css" />
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js"></script>
</head>
<body>
  <!-- Updated header layout -->
  <div class="header-controls">
    <!-- App title on the left -->
    <h1 class="app-title">Returns App</h1>
    
    <!-- Debug info in the middle -->
    <div class="debug-info">
      <small>Debug Info:</small>
      <small>Tables: {{ returns_tables|length if returns_tables else 'None' }}</small>
      {% if error %}
        <small style="color: red;">Error: {{ error }}</small>
      {% endif %}
      <small>Database Connection: {{ 'OK' if returns_tables is defined else 'Failed' }}</small>
      {% if returns_tables %}
        <small>
          <ul style="margin: 0; padding-left: 15px;">
          {% for table in returns_tables %}
            <li>{{ table.id }}: {{ table.name }}</li>
          {% endfor %}
          </ul>
        </small>
      {% endif %}
    </div>
    
    <!-- Table select on the right -->
    <div class="table-select">
      <select id="returnsTableSelect">
        <option value="">Select Returns Table</option>
        <option value="upload">Upload New Table...</option>
        {% for table in returns_tables %}
          <option value="{{ table.id }}">{{ table.name }}</option>
        {% endfor %}
      </select>
      <input type="file" id="fileInput" style="display: none;" accept=".xlsx,.xls,.csv,.xlsm">
    </div>
  </div>

  <!-- Table container -->
  {% if table_html %}
    <div class="table-container">
      {{ table_html|safe }}
    </div>
  {% endif %}

  <!-- Inline Popup Element -->
  <div id="popup" class="popup">
    <p>This is the popup content!</p>
    <button onclick="closePopup()">Close</button>
  </div>

  <!-- Remove the inline <script> that destroys or initializes #returnsTable here -->
  <!-- Rely on main.js for all DataTable logic -->

  <!-- Load popup.js first, then returns.js -->
  <script src="{{ url_for('static', filename='js/popup.js') }}"></script>
  <script src="{{ url_for('static', filename='js/returnstable.js') }}"></script>
</body>
</html>